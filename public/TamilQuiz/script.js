const topics = {
    "இந்திய தகவல்கள்": {
        paragraph: "இந்தியாவின் தேசிய வருமானத்தில் முக்கிய பங்கு வகிப்பது வேளாண்மை ஆகும். தென் மாநிலங்களில் மிக அதிக நீளமான கடற்கரையைக் கொண்ட மாநிலம் ஆந்திரப்பிரதேசம். இந்தியா விண்வெளி யுகத்திற்குள் நுழைந்ததற்குக் காரணமானவர் அப்துல் கலாம். இந்தியாவின் மிகப்பெரிய நதி கங்கை என்று குறிப்பிடப்படுகிறது. மேலும், இந்தியாவின் மிக உயர்ந்த இலக்கிய விருது ஞானபீட விருது ஆகும்.",
        questions: [
            {
                question: "இந்தியாவின் தேசிய வருமானத்தில் முக்கிய பங்கு வகிப்பது?",
                options: ["தொலைக்காட்சி", "தொழிற்சாலை", "சுற்றுலா", "வேளாண்மை"],
                correctAnswer: "வேளாண்மை"
            },
            {
                question: "மிக அதிக நீளமான கடற்கரையைக் கொண்ட தென் மாநிலம் எது?",
                options: ["தமிழ்நாடு", "ஆந்திரப்பிரதேசம்", "மகாராஷ்டிரா", "கேரளா"],
                correctAnswer: "ஆந்திரப்பிரதேசம்"
            },
            {
                question: "இந்தியா விண்வெளி யுகத்திற்குள் நுழைந்ததற்குக் காரணமானவர்",
                options: ["அலிமுகமது", "ஆகா கான்", "அப்துல் கலாம்", "சுல்தான்"],
                correctAnswer: "அப்துல் கலாம்"
            },
            {
                question: "இந்தியாவின் மிகப்பெரிய நதி எது?",
                options: ["பிரம்மபுத்திரா", "கங்கை", "கிருஷ்ணா", "சிந்து"],
                correctAnswer: "கங்கை"
            },
            {
                question: "இந்தியாவின் மிக உயர்ந்த இலக்கிய விருது எது?",
                options: ["கலைமாமணி விருது", "சாகித்ய அகாதெமி", "ஞானபீட விருது", "பத்மவிபூஷன் விருது"],
                correctAnswer: "ஞானபீட விருது"
            }
        ]
    },
    "சரித்திரம்": {
    "paragraph": "இது ஒரு பாரம்பரிய விளக்கம் இந்திய வரலாற்றில் முக்கியமான நிகழ்வுகள் பற்றி. இந்தியாவின் சுதந்திர போராட்டத்தில் மகாத்மா காந்தியின் பங்கு மிக முக்கியமானது. 1857 ஆம் ஆண்டு இந்தியாவின் முதல் சுதந்திரப் போராட்டம் பிரிட்டிஷ் ஆட்சிக்கு எதிராக நடந்தது.",
    "questions": [
        {
            "question": "இந்தியாவின் முதல் சுதந்திரப் போராட்டம் எப்போது நடைபெற்றது?",
            "options": ["1857", "1947", "1965", "1984"],
            "correctAnswer": "1857"
        },
        {
            "question": "இந்திய சுதந்திர போராட்டத்தில் முக்கியமான தலைவர் யார்?",
            "options": ["மகாத்மா காந்தி", "நேரு", "சுபாஷ் சந்திர போஸ்", "பகத்சிங்"],
            "correctAnswer": "மகாத்மா காந்தி"
        },
        {
            "question": "இந்திய சுதந்திர போராட்டத்தில் 1942ஆம் ஆண்டு நடைபெற்ற அமைதிப் போராட்டம் எது?",
            "options": ["கிளை ஆங்கிலேயரை வெளியேற்றுவோம்", "சத்யாக்ரஹம்", "சிவில் நாசகம்", "கீழ்ப்படிதல்"],
            "correctAnswer": "கிளை ஆங்கிலேயரை வெளியேற்றுவோம்"
        },
        {
            "question": "இந்திய சுதந்திரத்திற்குப் பிறகு முதல் பிரதமர் யார்?",
            "options": ["வல்லபாய் படேல்", "மகாத்மா காந்தி", "ஜவஹர்லால் நேரு", "சுபாஷ் சந்திர போஸ்"],
            "correctAnswer": "ஜவஹர்லால் நேரு"
        },
        {
            "question": "இந்திய சுதந்திர போராட்டத்தில் தந்தை என்று அழைக்கப்படுபவர் யார்?",
            "options": ["நேதாஜி", "மகாத்மா காந்தி", "பகத்சிங்", "அம்பேத்கர்"],
            "correctAnswer": "மகாத்மா காந்தி"
        }
    ]
},

    "வானியல்": {
    "paragraph": "வானியலில், வானத்தின் இயற்கை மற்றும் காற்றின் அமைப்புகளை ஆய்வு செய்கின்றனர். வெப்பம், மழை, காற்று மற்றும் புயல் போன்ற காலநிலைக் கூறுகள் பற்றிய விளக்கங்கள் இதில் அடங்கும். வானியல் ஆய்வு வானிலை அறிக்கைகளை வழங்க உதவுகின்றது.",
    "questions": [
        {
            "question": "வானிலை அறிக்கையில் எந்த மாதிரியான தகவல்கள் வழங்கப்படுகின்றன?",
            "options": ["வெப்பம்", "நீர்", "மண்ணின் தன்மை", "பேருந்து நேரம்"],
            "correctAnswer": "வெப்பம்"
        },
        {
            "question": "புயலின் போது எது அதிகம் ஏற்படுகிறது?",
            "options": ["காற்று", "மழை", "தூசு", "இடிகுரல்"],
            "correctAnswer": "காற்று"
        },
        {
            "question": "நான் நாளை பெய்யுமா என்பதை நமக்கு சொல்ல உதவும் விஞ்ஞானம் என்ன?",
            "options": ["வானியல்", "புவியியல்", "பொருளியல்", "உயிரியல்"],
            "correctAnswer": "வானியல்"
        },
        {
            "question": "கீழ்க்கண்டவையில், வானியல் தொடர்பானது எது?",
            "options": ["வானிலை ஆராய்ச்சி", "விவசாயம்", "மின் உற்பத்தி", "அறிவியல் கணிதம்"],
            "correctAnswer": "வானிலை ஆராய்ச்சி"
        },
        {
            "question": "வானிலை கண்காணிப்பதற்கான கருவி எது?",
            "options": ["மனோமீட்டர்", "அனிமோமீட்டர்", "நிகரோஸ்கோப்", "தெர்மோமீட்டர்"],
            "correctAnswer": "அனிமோமீட்டர்"
        }
    ]
},
"பொருளியல்": {
    "paragraph": "பொருளியல் என்பது பொருட்கள் மற்றும் சேவைகள் உற்பத்தி, விநியோகம் மற்றும் நுகர்வு குறித்த ஆய்வாகும். இது சமூகத்தின் வளங்களை எவ்வாறு பயன்படுத்துவது மற்றும் மக்களின் தேவைகளைப் பூர்த்தி செய்ய உதவுவது போன்றவற்றை ஆய்வு செய்கின்றது.",
    "questions": [
        {
            "question": "பொருளியலில் அடிப்படை அம்சங்கள் எவை?",
            "options": ["உற்பத்தி, விநியோகம், நுகர்வு", "கல்வி, விளையாட்டு, பொழுதுபோக்கு", "சமூகம், மரபு, கலாச்சாரம்", "அறிவியல், தொழில்நுட்பம், கலை"],
            "correctAnswer": "உற்பத்தி, விநியோகம், நுகர்வு"
        },
        {
            "question": "சர்வதேச வர்த்தகத்தில் பரிமாற்றக் கருவி எது?",
            "options": ["நாணயங்கள்", "சம்பாதிப்பு", "வங்கி கணக்கு", "முதலீட்டு திட்டம்"],
            "correctAnswer": "நாணயங்கள்"
        },
        {
            "question": "முக்கிய பொருளாதார அம்சம் எது?",
            "options": ["விலை நிலைத்தன்மை", "புதிதாக கற்றல்", "பொது அறிவு", "பணிநிலை பாதுகாப்பு"],
            "correctAnswer": "விலை நிலைத்தன்மை"
        },
        {
            "question": "நுகர்வோர் கொள்வனவின் போது ஏதாவது முடிவு செய்யும் செயல்முறை என்ன?",
            "options": ["திறன் பகுத்தறிதல்", "மொழிபெயர்ப்பு", "அறிவியல் ஆராய்ச்சி", "நன்மை அதிகபட்சம்"],
            "correctAnswer": "நன்மை அதிகபட்சம்"
        },
        {
            "question": "வணிகத்தில் வெற்றிக்கான முக்கிய அம்சம் என்ன?",
            "options": ["மார்க்கெட்டிங்", "தொழில்நுட்பம்", "கலைகள்", "இசை"],
            "correctAnswer": "மார்க்கெட்டிங்"
        }
    ]
},
"புவியியல்": {
    "paragraph": "புவியியல் என்பது பூமியின் புவி அமைப்பு, பருவ நிலைகள், நிலவியல் அமைப்பு, புவியின் வானிலை மற்றும் புவி பயன்பாட்டினை ஆய்வு செய்கின்றது. புவியியல் ஒரு அறிவியல் பாடமாகும் மற்றும் இது பூமியின் பல்வேறு பகுதிகளை ஆய்வு செய்கின்றது.",
    "questions": [
        {
            "question": "பூமியின் மையம் எப்படியானது?",
            "options": ["உருகிய இரும்பு", "உயிர்கள்", "வாழை மரங்கள்", "ஆயிரம் மீட்டர் உயரம்"],
            "correctAnswer": "உருகிய இரும்பு"
        },
        {
            "question": "எந்தக் கண்டம் அதிகமான பகுதிகளைக் கொண்டுள்ளது?",
            "options": ["ஆப்ரிக்கா", "ஆசியா", "ஐரோப்பா", "ஒத்த குடி"],
            "correctAnswer": "ஆசியா"
        },
        {
            "question": "எரிமலை எங்கு உள்ளன?",
            "options": ["ஆக்ட்டிக் கடலில்", "மாவட்டத்தில்", "புவியின் அடியில்", "விளையாட்டு மைதானத்தில்"],
            "correctAnswer": "புவியின் அடியில்"
        },
        {
            "question": "புவியில் எவ்வளவு மண்ணானது பயிரிட எடுக்கப்படுகிறது?",
            "options": ["தூங்கும் மண்ணும்", "மீன்சொல் மண்ணும்", "மிகச்சிறிய பகுதி", "தனியார் சொத்து"],
            "correctAnswer": "மிகச்சிறிய பகுதி"
        },
        {
            "question": "புவியில் மிகப்பெரிய கடல் எது?",
            "options": ["பசிபிக் கடல்", "அரபிக்கடல்", "ஹிந்துகடல்", "பொன்னி நதிக்கரைக்கரை"],
            "correctAnswer": "பசிபிக் கடல்"
        }
    ]
}

};

let score = 0;
let currentQuestionIndex = 0;
let selectedTopic = '';

const synth = window.speechSynthesis;
const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
recognition.lang = 'ta-IN';
recognition.interimResults = false;

function speakText(text) {
    return new Promise((resolve) => {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ta-IN';
        utterance.onend = resolve;
        synth.speak(utterance);
    });
}

function startGame() {
    const topicOptions = Object.keys(topics).join(", ");
    speakText("தயவு செய்து உங்கள் தலைப்பைத் தேர்ந்தெடுக்கவும். " + topicOptions)
    .then(() => {
        recognition.start();
        recognition.onresult = (event) => {
            const userTopic = event.results[0][0].transcript.trim();
            if (topics[userTopic]) {
                selectedTopic = userTopic;
                recognition.stop();
                presentTopic();
            } else {
                speakText("தயவு செய்து சரியான தலைப்பைச் சொல்லவும்.");
                startGame();
            }
        };
    });
}

function presentTopic() {
    const topic = topics[selectedTopic];
    speakText(topic.paragraph)
    .then(() => {
        document.getElementById("paragraph").textContent = topic.paragraph;
        askQuestion();
    });
}

function askQuestion() {
    const topic = topics[selectedTopic];
    if (currentQuestionIndex < topic.questions.length) {
        const { question, options } = topic.questions[currentQuestionIndex];
        const optionsText = options.join(", ");

        document.getElementById("questionText").textContent = question;
        document.getElementById("optionsText").textContent = `விருப்பங்கள்: ${optionsText}`;

        speakText(question)
        .then(() => speakText(`விருப்பங்கள்: ${optionsText}`))
        .then(() => {
            recognition.start();
            recognition.onresult = (event) => {
                const userAnswer = event.results[0][0].transcript;
                checkAnswer(userAnswer);
            };
        });
    } else {
        endGame();
    }
}

function checkAnswer(userAnswer) {
    const topic = topics[selectedTopic];
    const { correctAnswer } = topic.questions[currentQuestionIndex];
    if (userAnswer.includes(correctAnswer)) {
        score++;
    }
    currentQuestionIndex++;
    setTimeout(() => {
        askQuestion();
    }, 1000); // Short pause before the next question
}

function endGame() {
    const finalScoreMessage = `நீங்கள் பெற்ற மொத்த மதிப்பெண்: ${score} / ${topics[selectedTopic].questions.length}`;
    document.getElementById("score").textContent = finalScoreMessage;
    speakText(finalScoreMessage);
}
